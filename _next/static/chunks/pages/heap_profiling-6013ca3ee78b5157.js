(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{84808:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/heap_profiling",function(){return t(16445)}])},16445:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return _}});var l=t(85893),o=t(40639),a=t(83234),i=t(57026),c=t(47741),r=t(63764),s=t(45772),u=t.n(s),d=t(42474),h=t(9008),f=t.n(h),p=t(1864),g=t.n(p),m=t(67294),x=t(65098),j=t(6448),w=t(43231),y=t(3526),v=t(44162),C=t(86357);function _(){let{response:e}=(0,v.Z)(y.OL),[n,t]=(0,m.useState)(),[s,h]=(0,m.useState)(""),[p,_]=(0,m.useState)(),[P,E]=(0,m.useState)(),[b,N]=(0,m.useState)("Auto"),[k,z]=(0,m.useState)();async function D(e,n){if(e&&n&&e.length>0)try{let e=C.R_.fromJSON(await w.ZP.get("/monitor/list_heap_profile/".concat(n)));_(e)}catch(e){console.error(e),h("Getting Profiling File List\n\nError: ".concat(e.message,"\n").concat(e.cause))}}async function S(){try{await w.ZP.get("/monitor/dump_heap_profile/".concat(n)),D(e,n)}catch(e){h("Dumping heap profile.\n\nError: ".concat(e.message,"\n").concat(e.cause))}}async function A(){let e;if(void 0===P||void 0===k){console.log("selectedProfileList: ".concat(P,", analyzeTargetFileName: ").concat(k));return}let t=g().join(P.dir,k);h("Analyzing ".concat(k," from Compute Node ").concat(n));let l="Collapsed Profiling of Compute Node ".concat(n," for ").concat(k);try{let o=u()(t),a=await fetch("/monitor/analyze/".concat(n,"/").concat(o)).then(async e=>({filename:e.headers.get("content-disposition"),blob:await e.blob()})),i=window.URL.createObjectURL(a.blob),c=document.createElement("a");c.href=i,c.download=a.filename||(0,d.randomUUID)(),c.click(),e="".concat(l,"\n\nDownloaded!")}catch(n){e="".concat(l,"\n\nError: ").concat(n.message)}h(e)}(0,m.useEffect)(()=>{e&&!n&&e.length>0&&t(e[0].id)},[e,n]),(0,m.useEffect)(()=>{D(e,n)},[e,n]),(0,m.useEffect)(()=>{p&&("Auto"===b?E({dir:p.dir,name:p.nameAuto}):"Manually"===b?E({dir:p.dir,name:p.nameManually}):console.error("Bad profileType ".concat(b)))},[b,p]),(0,m.useEffect)(()=>{P&&P.name.length>0&&z(P.name[0])},[P]);let X=(0,l.jsxs)(o.kC,{p:3,height:"calc(50vh - 20px)",flexDirection:"column",children:[(0,l.jsx)(j.Z,{children:"Heap Profiling"}),(0,l.jsxs)(o.kC,{flexDirection:"row",height:"full",width:"full",children:[(0,l.jsxs)(o.gC,{mr:3,spacing:3,alignItems:"flex-start",width:200,height:"full",children:[(0,l.jsxs)(a.NI,{children:[(0,l.jsx)(a.lX,{textColor:"blue.500",children:"Dump Heap Profile"}),(0,l.jsxs)(o.gC,{children:[(0,l.jsx)(a.lX,{children:"Compute Nodes"}),(0,l.jsx)(i.Ph,{onChange:e=>t(parseInt(e.target.value)),children:e&&e.map(e=>{var n,t;return(0,l.jsxs)("option",{value:e.id,children:["(",e.id,") ",null===(n=e.host)||void 0===n?void 0:n.host,":",null===(t=e.host)||void 0===t?void 0:t.port]},e.id)})}),(0,l.jsx)(c.zx,{onClick:e=>S(),width:"full",children:"Dump"})]})]}),(0,l.jsxs)(a.NI,{children:[(0,l.jsx)(a.lX,{textColor:"blue.500",children:"Analyze Heap Profile"}),(0,l.jsxs)(o.gC,{children:[(0,l.jsx)(a.lX,{children:"Dumped By"}),(0,l.jsx)(i.Ph,{onChange:e=>N(e.target.value),children:["Auto","Manually"].map(e=>(0,l.jsx)("option",{value:e,children:e},e))}),(0,l.jsx)(a.lX,{children:"Dumped Files"}),(0,l.jsx)(i.Ph,{onChange:e=>z(e.target.value),children:P&&P.name.map(e=>(0,l.jsx)("option",{value:e,children:e},e))}),(0,l.jsx)(c.zx,{onClick:e=>A(),width:"full",children:"Analyze"})]})]})]}),(0,l.jsx)(o.xu,{flex:1,height:"full",ml:3,overflowX:"scroll",overflowY:"scroll",children:void 0===s?(0,l.jsx)(x.Z,{}):(0,l.jsx)(r.ZP,{language:"sql",options:{fontSize:13,readOnly:!0,renderWhitespace:"boundary",wordWrap:"on"},defaultValue:'Select a compute node and target profiling result file and click "Analyze"...',value:s})})]})]});return(0,l.jsxs)(m.Fragment,{children:[(0,l.jsx)(f(),{children:(0,l.jsx)("title",{children:"Heap Profiling"})}),X]})}}},function(e){e.O(0,[714,295,958,425,888,774,179],function(){return e(e.s=84808)}),_N_E=e.O()}]);